# MCP功能使用说明

## 🎯 功能概述

MCP (Model Context Protocol) 功能已成功集成到AI-Diary中！这个功能让AI能够"记住"你的偏好和习惯，提供更加个性化的日记分析体验。

## 🚀 如何使用

### 1. 首次访问

1. **启动应用**：运行 `python src/main.py`
2. **访问首页**：打开 http://localhost:5000
3. **登录**：使用默认密码 `1234` 登录

### 2. 配置AI服务

在开始使用MCP功能前，需要先配置AI服务：

1. 点击设置按钮进入设置页面
2. 在"AI 设置"部分配置：
   - **AI API 地址**：如 `https://api.openai.com/v1`
   - **AI API 密钥**：你的OpenAI API密钥
   - **AI 模型**：如 `gpt-3.5-turbo` 或 `gpt-4`
3. 点击"保存配置"

### 3. 访问MCP设置

在设置页面，你会看到新的"MCP 设置"卡片：

- **服务器管理**：配置和管理MCP服务器
- **AI 记忆**：查看和管理AI对你的了解

点击"配置"或"查看"按钮进入MCP设置页面。

### 4. 开始写日记，让AI学习！

现在开始正常写日记，AI会自动学习你的偏好：

**示例场景：**

1. **第一次提到**：
   ```
   用户写：今天吃了兰州拉面，味道很棒！
   AI回复：听起来你今天品尝了美味的兰州拉面呢！看来你很享受这顿饭...
   ```
   🧠 *AI自动记录：兰州拉面 → 用户喜欢，觉得味道很棒*

2. **后续相关内容**：
   ```
   用户：[上传兰州拉面照片]
   AI回复：看起来又是你喜欢的兰州拉面呢！上次你说很好吃，这次味道怎么样？
   ```
   🎯 *AI基于记忆提供个性化回应*

## 📊 查看AI记忆

在 设置 → MCP设置 → AI记忆 中，你可以：

- **记忆统计**：查看总记忆数量和分类统计
- **记忆列表**：浏览所有AI记住的关于你的信息
- **搜索记忆**：搜索特定的记忆内容
- **管理记忆**：删除不需要的记忆

### 记忆类型

- **偏好 (preference)**：食物、活动等喜好
- **习惯 (habit)**：日常行为模式
- **事实 (fact)**：关于你的客观信息
- **情感 (emotion)**：情绪状态和感受
- **经历 (experience)**：重要经历和事件

## 🔧 高级功能

### 自定义MCP服务器

除了内置的用户记忆服务器，你还可以添加自定义MCP服务器：

1. 在"服务器管理"中点击"添加服务器"
2. 按标准MCP格式配置：
   ```json
   {
     "name": "time",
     "command": "uvx", 
     "args": ["mcp-server-time", "--local-timezone=Asia/Shanghai"]
   }
   ```

### 执行日志

在"执行日志"标签页可以查看所有MCP工具的调用记录，用于调试和监控。

## ❓ 常见问题

**Q: 看不到记忆数据？**
A: 需要先写一些日记让AI分析，AI会自动提取和存储记忆信息。

**Q: MCP页面显示需要登录？**
A: 请先在首页登录，然后再访问MCP设置页面。

**Q: AI没有体现对我的了解？**
A: 确保已正确配置AI API密钥，并且写了足够的日记内容供AI学习。

**Q: 想要清空所有记忆？**
A: 在AI记忆页面点击"清空所有记忆"按钮，但请注意此操作不可恢复。

## 🎉 享受个性化体验

现在你的AI日记助手能够：
- 记住你的喜好和习惯
- 提供更加个性化的回应  
- 理解你的生活模式
- 基于历史了解给出建议

开始写日记，让AI真正了解你吧！ ✨